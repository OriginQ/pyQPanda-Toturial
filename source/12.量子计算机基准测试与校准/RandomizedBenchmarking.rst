
éšæœºåŸºå‡†
==========================

ç®€ä»‹
--------------

éšæœºåŸºå‡†æµ‹è¯•ï¼ˆRandomized Benchmarkingï¼ŒRBï¼‰æ˜¯é‡å­è®¡ç®—ä¸­ä¸€ç§ç”¨äºé‡å­é—¨æ€§èƒ½è¯„ä¼°çš„å®éªŒæŠ€æœ¯ã€‚å®ƒç”¨äºæµ‹é‡é‡å­é—¨çš„é”™è¯¯ç‡ï¼Œæä¾›äº†å…³äºé‡å­è®¡ç®—ç³»ç»Ÿçš„å™ªå£°æ°´å¹³å’Œç¨³å®šæ€§çš„ä¿¡æ¯ã€‚RB æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„æ–¹æ³•ï¼Œç”¨äºè¯„ä¼°é‡å­è®¾å¤‡çš„å¯é æ€§å’Œé”™è¯¯ç‡ã€‚


ç®—æ³•æµç¨‹
--------------

åœ¨éšæœºåŸºå‡†æµ‹è¯•ä¸­ï¼Œä¸»è¦æ€æƒ³æ˜¯é€šè¿‡å¯¹éšæœºåºåˆ—çš„ä¸€ç³»åˆ—é‡å­é—¨æ“ä½œè¿›è¡Œæµ‹é‡ï¼Œæ¥è¯„ä¼°é‡å­é—¨çš„é”™è¯¯ç‡ã€‚è¿™äº›éšæœºåºåˆ—çš„ç‰¹ç‚¹æ˜¯å®ƒä»¬ä¼šè¶‹å‘äºäº’ç›¸æŠµæ¶ˆï¼Œä»è€Œå‡å°‘ç³»ç»Ÿå™ªå£°çš„å½±å“ã€‚é€šè¿‡æ¯”è¾ƒå®é™…æµ‹é‡ç»“æœå’Œç†è®ºé¢„æœŸï¼Œå¯ä»¥ä¼°è®¡å‡ºé‡å­é—¨çš„é”™è¯¯ç‡ã€‚

å®éªŒè¿‡ç¨‹å¦‚ä¸‹ï¼š

1. ç”Ÿæˆéšæœºåºåˆ—ï¼šç”Ÿæˆä¸€ç³»åˆ—éšæœºçš„é‡å­é—¨åºåˆ—ï¼Œè¿™äº›åºåˆ—æ¶µç›–äº†ä¸åŒçš„é‡å­é—¨æ“ä½œå’Œé¡ºåºã€‚

2. å®éªŒæ“ä½œï¼šåœ¨é‡å­è®¾å¤‡ä¸Šä¾æ¬¡æ‰§è¡Œç”Ÿæˆçš„éšæœºåºåˆ—ã€‚

3. æµ‹é‡ç»“æœï¼šå¯¹æ¯ä¸ªéšæœºåºåˆ—ï¼Œæµ‹é‡é‡å­æ¯”ç‰¹çš„çŠ¶æ€ï¼Œå¹¶è®°å½•æµ‹é‡ç»“æœã€‚

1ï¼Œ2ï¼Œ3æ­¥çš„å…·ä½“æ“ä½œå¦‚ä¸‹ï¼š

.. admonition:: 1,2,3æ­¥çš„å…·ä½“æ“ä½œ
   :class: tip

    åœ¨Cliffordç¾¤ä¸­éšæœºéœ€æ±‚mä¸ªé—¨ï¼Œæ„æˆä¸€ä¸ªåºåˆ—ï¼›
    è®¡ç®—è¯¥åºåˆ—çš„ç­‰æ•ˆ :math:`U` æ“ä½œï¼Œè¯¥æ“ä½œçš„é€† :math:`\mathrm{U}^{-1}` ä¸€å®šä¹Ÿåœ¨Cliffordç¾¤ä¸­ï¼Œå°† :math:`\mathrm{U}^{-1}` æ·»åŠ åˆ°åºåˆ—ä¸­ä½œä¸ºç¬¬m+1ä¸ªå…ƒç´ ï¼Œæ„æˆä¸€ä¸ªå®Œæ•´çš„åºåˆ—;
    æµ‹é‡é‡å­æ¯”ç‰¹åœ¨è¯¥åºåˆ—æ“ä½œä¹‹åçš„0æ€ï¼ˆåˆæ€åœ¨0æ€ï¼‰ä¿çœŸåº¦ :math:`y_{mk}` ã€‚

4. åˆ†æï¼šé€šè¿‡æ¯”è¾ƒé¢„æœŸæµ‹é‡ç»“æœå’Œå®é™…æµ‹é‡ç»“æœï¼Œå¯ä»¥å¾—å‡ºé‡å­é—¨çš„é”™è¯¯ç‡ã€‚é€šå¸¸ä½¿ç”¨æŒ‡æ•°é€’å‡æ¨¡å‹æ¥åˆ†æé”™è¯¯ç‡ã€‚

5. é”™è¯¯ç‡ä¼°è®¡ï¼šé€šè¿‡åˆ†æè·å¾—çš„æ•°æ®ï¼Œå¯ä»¥ä¼°è®¡å‡ºä¸åŒé‡å­é—¨çš„å¹³å‡é”™è¯¯ç‡ã€‚



.. admonition:: 4,5æ­¥çš„å…·ä½“æ“ä½œ
   :class: tip


    è®¡ç®—åºåˆ—é•¿åº¦ä¸ºmæ—¶çš„å¹³å‡ä¿çœŸåº¦ :math:`y_m=\frac{1}{K} \sum_1^K y_{m k}` , å¾—åˆ°åºåˆ—å¹³å‡ä¿çœŸåº¦yå’Œåºåˆ—é•¿åº¦mçš„å…³ç³»ï¼Œå¹¶ç”¨å…¬å¼ä¸‹é¢æ‹Ÿåˆï¼š

    .. math::

        \begin{aligned}
        y=A * p^m+B
        \end{aligned}

    é—¨æ“ä½œå¹³å‡é”™è¯¯ç‡ :math:`r_c` ä¸æ‹Ÿåˆå‚æ•°ğ‘çš„å…³ç³»ï¼š

    .. math::

        \begin{aligned}
        r_c=(1-p) *\left(2^n-1\right) / 2^n
        \end{aligned}




éšç€Cliffordé—¨æ•°é‡çš„å¢åŠ ï¼Œé—¨åºåˆ—çš„å¹³å‡æˆåŠŸæ¦‚ç‡ä¼šä¸‹é™ï¼Œå› ä¸ºå½“é‡å¤åº”ç”¨åŒ…å«é”™è¯¯çš„é‡å­é—¨æ—¶ï¼Œæ•´ä¸ªé—¨åºåˆ—çš„é”™è¯¯æ¦‚ç‡ä¼šå•è°ƒå¢åŠ ,åœ¨ RB ä¸­ï¼Œé€šå¸¸å‡è®¾ä¸åŒCliffordçš„å™ªå£°è¶…ç®—å­ç›¸ç­‰ï¼Œåœ¨æ­¤å‡è®¾ä¸‹ï¼Œé—¨åºåˆ—çš„å¹³å‡æˆåŠŸæ¦‚ç‡å·²è¢«è¯æ˜éšCliffordé—¨çš„æ•°é‡å‘ˆæŒ‡æ•°è¡°å‡ã€‚

æ¥å£è¯´æ˜
--------------

1.å•é—¨éšæœºåŸºå‡†æµ‹è¯•ï¼š ``single_qubit_rb`` ã€‚

.. function:: single_qubit_rb(qvm: QuantumMachine, qubit: Qubit, clifford_range: List[int], num_circuits: int, shots: int, chip_id: int = 2, interleaved_gates: List[QGate] = []) -> Dict[int, float]

    è¯¥å‡½æ•°ç”¨äºåœ¨é‡å­èŠ¯ç‰‡ä¸Šè¿›è¡Œå•æ¯”ç‰¹éšæœºåŸºå‡†æµ‹è¯•ã€‚é€šè¿‡å¯¹æŒ‡å®šçš„å•æ¯”ç‰¹é‡å­çº¿è·¯è¿›è¡ŒéšæœºåŒ–çš„ Clifford é—¨åºåˆ—æ“ä½œï¼Œä»¥è¯„ä¼°é‡å­è®¾å¤‡çš„æ€§èƒ½ã€‚

    :param qvm: é‡å­æœºå™¨å¯¹è±¡ï¼Œå¯ä»¥æ˜¯èŠ¯ç‰‡å®é™…æˆ–æ¨¡æ‹Ÿé‡å­æœºå™¨ã€‚
    :type qvm: QuantumMachine
    :param qubit: å¾…æµ‹è¯•çš„å•æ¯”ç‰¹é‡å­æ¯”ç‰¹ã€‚
    :type qubit: Qubit
    :param clifford_range: Clifford é—¨åºåˆ—çš„èŒƒå›´åˆ—è¡¨ï¼Œç”¨äºæ„å»ºéšæœºåºåˆ—ã€‚
    :type clifford_range: List[int]
    :param num_circuits: éšæœºåºåˆ—çš„æ•°é‡ï¼Œç”¨äºç»Ÿè®¡ç»“æœã€‚
    :type num_circuits: int
    :param shots: æ¯ä¸ªåºåˆ—çš„æµ‹é‡æ¬¡æ•°ï¼Œç”¨äºè·å–ç»Ÿè®¡æ¦‚ç‡ã€‚
    :type shots: int
    :param chip_id: èŠ¯ç‰‡æ ‡è¯†ï¼Œé»˜è®¤ä¸º 2ï¼ˆæœ¬æºæ‚Ÿæº5å·ï¼‰ã€‚
    :type chip_id: int, optional
    :param interleaved_gates: ç”¨äºæ’å…¥éšæœºåºåˆ—çš„é—¨æ“ä½œåˆ—è¡¨ï¼Œé»˜è®¤ä¸ºç©ºåˆ—è¡¨ã€‚
    :type interleaved_gates: List[QGate], optional
    :return: åŒ…å«æµ‹è¯•ç»“æœæ•°æ®çš„å­—å…¸ï¼Œé”®ä¸º Clifford é—¨åºåˆ—é•¿åº¦ï¼Œå€¼ä¸ºå¯¹åº”çš„æŒ‡æ•°è¡°å‡æŒ‡æ•°ã€‚
    :rtype: Dict[int, float]
    :raises run_fail: å•æ¯”ç‰¹éšæœºåŸºå‡†æµ‹è¯•è¿è¡Œå¤±è´¥ã€‚

    ç¤ºä¾‹ç”¨æ³•::

        # åœ¨é‡å­èŠ¯ç‰‡ä¸Šå¯¹å•æ¯”ç‰¹è¿›è¡ŒéšæœºåŸºå‡†æµ‹è¯•
        result_dict = single_qubit_rb(my_qvm, qubit=qubit_0, clifford_range=[1, 10, 20], num_circuits=100, shots=1024)

        # åœ¨é‡å­èŠ¯ç‰‡ä¸Šå¯¹å•æ¯”ç‰¹è¿›è¡ŒéšæœºåŸºå‡†æµ‹è¯•ï¼Œæ’å…¥é¢å¤–çš„é—¨æ“ä½œ
        result_dict = single_qubit_rb(my_qvm, qubit=qubit_1, clifford_range=[1, 5, 10], num_circuits=50, shots=512, interleaved_gates=[H(qubit_1)])

2.åŒé—¨éšæœºåŸºå‡†æµ‹è¯•ï¼š ``double_qubit_rb`` ã€‚

.. function:: double_qubit_rb(qvm: QuantumMachine, qubit0: Qubit, qubit1: Qubit, clifford_range: List[int], num_circuits: int, shots: int, chip_id: int = 2, interleaved_gates: List[QGate] = []) -> Dict[int, float]

    è¯¥å‡½æ•°ç”¨äºåœ¨ç»™å®šçš„åŒé‡å­æ¯”ç‰¹ä¸Šè¿›è¡ŒéšæœºåŸºå‡†æµ‹è¯•ï¼Œæµ‹è¯•èŠ¯ç‰‡æˆ–é‡å­æ¨¡æ‹Ÿå™¨çš„å™ªå£°æ°´å¹³ã€‚
    
    :param qvm: é‡å­æœºå™¨ã€‚
    :type qvm: QuantumMachine
    :param qubit0: ç¬¬ä¸€ä¸ªåŒé‡å­æ¯”ç‰¹ã€‚
    :type qubit0: Qubit
    :param qubit1: ç¬¬äºŒä¸ªåŒé‡å­æ¯”ç‰¹ã€‚
    :type qubit1: Qubit
    :param clifford_range: Cliffordåºåˆ—çš„é•¿åº¦èŒƒå›´åˆ—è¡¨ã€‚
    :type clifford_range: List[int]
    :param num_circuits: æµ‹è¯•ç”µè·¯æ•°é‡ã€‚
    :type num_circuits: int
    :param shots: æµ‹é‡çš„æ¬¡æ•°ã€‚
    :type shots: int
    :param chip_id: èŠ¯ç‰‡æ ‡è¯†ï¼Œé»˜è®¤ä¸º2ï¼ˆæœ¬æºæ‚Ÿæº5å·ï¼‰ã€‚
    :type chip_id: int, optional
    :param interleaved_gates: äº¤é”™é—¨åˆ—è¡¨ï¼Œé»˜è®¤ä¸ºç©ºåˆ—è¡¨ã€‚
    :type interleaved_gates: List[QGate], optional
    :return: åŒ…å«æµ‹è¯•ç»“æœçš„å­—å…¸ï¼Œé”®ä¸ºCliffordåºåˆ—çš„é•¿åº¦ï¼Œå€¼ä¸ºå¯¹åº”çš„æµ‹è¯•ç»“æœï¼ˆæˆåŠŸæ¦‚ç‡ï¼‰ã€‚
    :rtype: Dict[int, float]
    :raises run_fail: åŒé‡å­æ¯”ç‰¹éšæœºåŸºå‡†æµ‹è¯•å¤±è´¥ã€‚

    ç¤ºä¾‹ç”¨æ³•ï¼ˆä¸æ’å…¥é—¨æ“ä½œï¼‰::

        # åœ¨é‡å­èŠ¯ç‰‡ä¸Šå¯¹åŒé‡å­æ¯”ç‰¹è¿›è¡ŒéšæœºåŸºå‡†æµ‹è¯•
        result_dict = double_qubit_rb(my_qvm, qubit0, qubit1, clifford_range=[1, 10, 20], num_circuits=100, shots=1024)

        # åœ¨é‡å­èŠ¯ç‰‡ä¸Šå¯¹åŒé‡å­æ¯”ç‰¹è¿›è¡ŒéšæœºåŸºå‡†æµ‹è¯•ï¼Œå¹¶æ’å…¥é¢å¤–çš„CZé—¨æ“ä½œ
        result_dict = double_qubit_rb(my_qvm, qubit0, qubit1, clifford_range=[1, 10, 20], num_circuits=100, shots=1024, interleaved_gates=[CZ(qubit0, qubit1)])

å®ä¾‹
--------------

.. code-block:: python

    from pyqpanda import *

    if __name__=="__main__":  
        # æ„å»ºå™ªå£°è™šæ‹Ÿæœºï¼Œè°ƒæ•´å™ªå£°æ¨¡æ‹ŸçœŸå®èŠ¯ç‰‡
        qvm = NoiseQVM()
        qvm.init_qvm()
        qvm.set_noise_model(NoiseModel.DEPOLARIZING_KRAUS_OPERATOR, GateType.CZ_GATE, 0.005)
        qvm.set_noise_model(NoiseModel.DEPOLARIZING_KRAUS_OPERATOR, GateType.PAULI_Y_GATE, 0.005)
        qv = qvm.qAlloc_many(4)

        # åŒæ ·å¯ä»¥ç”³è¯·äº‘è®¡ç®—æœºå™¨ï¼ˆé‡‡ç”¨çœŸå®èŠ¯ç‰‡ï¼‰
        # qvm =  QCloud()
        # qvm.init_qvm("898D47CF515A48CEAA9F2326394B85C6")

        # è®¾ç½®éšæœºçº¿è·¯ä¸­cliffordé—¨é›†æ•°é‡
        range = [ 5,10,15 ]

        # æµ‹é‡å•æ¯”ç‰¹éšæœºåŸºå‡†
        res = single_qubit_rb(qvm, qv[0], range, 10, 1000)

        # åŒæ ·å¯ä»¥æµ‹é‡ä¸¤æ¯”ç‰¹éšæœºåŸºå‡†
        #res = double_qubit_rb(qvm, qv[0], qv[1], range, 10, 1000)
       
        # å¯¹åº”çš„æ•°å€¼éšå™ªå£°å½±å“ï¼Œå™ªå£°æ•°å€¼è¶Šå¤§ï¼Œæ‰€å¾—ç»“æœè¶Šå°ï¼Œä¸”éšcliffordé—¨é›†æ•°é‡å¢å¤šï¼Œç»“æœæ•°å€¼è¶Šå°ã€‚
        print(res)

        qvm.finalize()

è¿è¡Œç»“æœï¼š

::
    
    {5: 0.9996, 10: 0.9999, 15: 0.9993000000000001}


å‚è€ƒæ–‡çŒ®
----

::

    [1] Easwar Magesan, J. M. Gambetta, and Joseph Emerson, Robust randomized benchmarking of quantum processes, https://arxiv.org/abs/1009.3639.
    [2] Easwar Magesan, Jay M. Gambetta, and Joseph Emerson, Characterizing Quantum Gates via Randomized Benchmarking, https://arxiv.org/abs/1109.6887.